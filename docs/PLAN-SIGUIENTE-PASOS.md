# Plan de Pr√≥ximos Pasos - Turnero ZS

**Fecha de An√°lisis**: 2025-10-03
**Estado del Proyecto**: Sprint 1 Completado ‚úÖ - Errores TypeScript Pendientes üî¥

---

## Estado Actual del Proyecto

### ‚úÖ Completado (Sprint 1)
- **Infraestructura Base**: shadcn/ui completamente configurado (13 componentes)
- **CRUD Zonas**: `/app/(dashboard)/zonas/page.tsx`
- **CRUD Instituciones**: `/app/(dashboard)/instituciones/page.tsx`
- **CRUD Profesionales**: `/app/(dashboard)/profesionales/page.tsx`
- **CRUD Pacientes**: `/app/(dashboard)/pacientes/page.tsx` (validaci√≥n DNI argentino)
- **CRUD Usuarios/Membres√≠as**: `/app/(dashboard)/usuarios/page.tsx` (sistema de roles)

### üî¥ Errores Cr√≠ticos Actuales
**Archivo**: `app/(public)/pantalla/[slug]/page.tsx`

```
‚ùå Property 'slug' does not exist on type 'Institution' (l√≠nea 214)
‚ùå Property 'status' does not exist on type Realtime event (l√≠neas 296-297)
‚ùå 'audioRef.current' is possibly 'null' (l√≠nea 307)
```

**Impacto**: El proyecto no compila (`npm run typecheck` falla)

---

## Pr√≥ximos Pasos Detallados

### 1. üî¥ PRIORIDAD CR√çTICA: Corregir Errores TypeScript
**Tiempo estimado**: 1-2 horas

**Tareas**:
- [ ] Agregar propiedad `slug` al tipo `Institution` o usar campo existente
- [ ] Tipar correctamente eventos de Supabase Realtime (`status` en payload)
- [ ] Implementar null-safety para `audioRef.current`
- [ ] Ejecutar `npm run typecheck` para verificar
- [ ] Ejecutar `npm run lint` para verificar c√≥digo

**Archivos afectados**:
- `app/(public)/pantalla/[slug]/page.tsx`
- Posiblemente tipos en `lib/` o definiciones de interfaces

---

### 2. üü° SPRINT 2: Sistema de Turnos Completo
**Tiempo estimado**: 2-3 semanas

#### 2A. CRUD Consultorios (Rooms)
**Archivo**: `app/(dashboard)/consultorios/page.tsx` ‚úÖ Ya existe

**Funcionalidades a implementar**:
- [ ] Crear/Editar/Eliminar consultorios
- [ ] Relaci√≥n con instituciones (select dropdown)
- [ ] Campos: nombre, n√∫mero, piso, estado (activo/inactivo)
- [ ] Capacidad (opcional para salas de espera)
- [ ] Tabla con listado y filtros

**Modelo de datos**:
```typescript
interface Room {
  id: string
  institution_id: string
  name: string
  room_number: string
  floor?: string
  is_active: boolean
  created_at: string
  updated_at: string
}
```

---

#### 2B. CRUD Servicios (Services)
**Archivo**: `app/(dashboard)/servicios/page.tsx` ‚úÖ Ya existe

**Funcionalidades a implementar**:
- [ ] Crear/Editar/Eliminar servicios m√©dicos
- [ ] Relaci√≥n con instituciones
- [ ] Asignaci√≥n a profesionales (relaci√≥n many-to-many)
- [ ] Campos: nombre, descripci√≥n, duraci√≥n estimada
- [ ] Color para identificaci√≥n visual

**Modelo de datos**:
```typescript
interface Service {
  id: string
  institution_id: string
  name: string
  description?: string
  duration_minutes: number
  color?: string
  is_active: boolean
}
```

---

#### 2C. Sistema de Horarios y Agenda
**Archivos**:
- `app/(dashboard)/horarios/page.tsx` ‚úÖ Ya existe
- `app/(dashboard)/agenda/page.tsx` ‚úÖ Ya existe

**Funcionalidades a implementar**:
- [ ] Definir horarios de trabajo de profesionales
- [ ] Configuraci√≥n por d√≠a de semana
- [ ] Generaci√≥n autom√°tica de slots de turnos
- [ ] Gesti√≥n de excepciones (feriados, ausencias)
- [ ] Vista de calendario mensual/semanal

**Modelo de datos**:
```typescript
interface Schedule {
  id: string
  professional_id: string
  day_of_week: number // 0-6 (domingo-s√°bado)
  start_time: string  // HH:MM
  end_time: string    // HH:MM
  slot_duration: number // minutos
  is_active: boolean
}

interface Slot {
  id: string
  professional_id: string
  service_id?: string
  datetime: string
  is_available: boolean
  locked_until?: string // Para concurrencia
}
```

---

#### 2D. Refactorizar Sistema de Turnos
**Archivos existentes** (3 versiones):
- `app/(dashboard)/turnos/page.tsx`
- `app/(dashboard)/turnos/page-simple.tsx`
- `app/(dashboard)/turnos/page-original.tsx`

**Tareas**:
- [ ] Analizar las 3 versiones y consolidar en una sola
- [ ] Implementar m√°quina de estados completa:
  - `pendiente` ‚Üí `esperando` ‚Üí `llamado` ‚Üí `en_consulta` ‚Üí `finalizado`
  - Transiciones: `cancelado`, `ausente`
- [ ] Integrar sistema de bloqueo de slots (ver `db/slot-locks-schema.sql`)
- [ ] Prevenir doble reserva con transacciones
- [ ] A√±adir filtros: fecha, profesional, servicio, estado
- [ ] B√∫squeda de pacientes por DNI/nombre
- [ ] Confirmaci√≥n de turnos
- [ ] Notificaciones (toast) para cambios de estado

**Componentes necesarios**:
- Selector de fecha (react-day-picker ya instalado)
- Selector de horarios disponibles
- Formulario de reserva
- Tabla de turnos con acciones

---

#### 2E. Vista de Turnos Disponibles
**Archivo**: `app/(dashboard)/turnos-disponibles/page.tsx` ‚úÖ Ya existe

**Funcionalidades**:
- [ ] Vista p√∫blica/administrativa de slots disponibles
- [ ] Filtros: instituci√≥n, profesional, servicio, rango de fechas
- [ ] Calendario visual con disponibilidad
- [ ] Indicadores de ocupaci√≥n (X disponibles de Y totales)
- [ ] Opci√≥n de reserva r√°pida

---

### 3. üü¢ SPRINT 3: Real-time y Experiencia del Usuario
**Tiempo estimado**: 1-2 semanas

#### 3A. Pantalla P√∫blica (Ya iniciada)
**Archivo**: `app/(public)/pantalla/[slug]/page.tsx`

**Mejoras a implementar**:
- [x] Correcci√≥n de errores TypeScript (debe hacerse primero)
- [ ] Optimizar suscripci√≥n a Supabase Realtime channels
- [ ] Mejorar sistema de llamados con sonido (TTS o audio pregrabado)
- [ ] A√±adir animaciones de transici√≥n
- [ ] Modo de accesibilidad (alto contraste, texto grande)
- [ ] Soporte multi-idioma (espa√±ol/guaran√≠ para contexto argentino)
- [ ] Visualizaci√≥n de m√∫ltiples consultorios simult√°neos
- [ ] Indicador de conexi√≥n en tiempo real

**Caracter√≠sticas actuales detectadas**:
- ‚úÖ Suscripci√≥n a eventos de llamados
- ‚úÖ Visualizaci√≥n de turnos en espera y en consulta
- ‚úÖ Toggle de sonido
- ‚úÖ Anonimizaci√≥n de nombres

---

#### 3B. Vista de Profesional (Llamar Pacientes)
**Archivo**: `app/(dashboard)/profesional/page.tsx` ‚úÖ Ya existe

**Funcionalidades a implementar**:
- [ ] Lista de turnos asignados al profesional (filtro por usuario logueado)
- [ ] Bot√≥n "Llamar Paciente" (cambia estado a `llamado`)
- [ ] Bot√≥n "Iniciar Consulta" (cambia estado a `en_consulta`)
- [ ] Bot√≥n "Finalizar" (cambia estado a `finalizado`)
- [ ] Registro autom√°tico de eventos de llamado (tabla `call_events`)
- [ ] Temporizador de tiempo en consulta
- [ ] Notas r√°pidas de consulta
- [ ] Marcar como ausente/cancelado
- [ ] Visualizaci√≥n de historia de turnos del paciente

**Integraci√≥n Realtime**:
- Emitir eventos al llamar paciente para actualizar pantalla p√∫blica
- Escuchar confirmaciones de paciente (opcional para futuro)

---

### 4. üîµ SPRINT 4: Consolidaci√≥n de Base de Datos
**Tiempo estimado**: 1 semana

#### Archivos de DB Actuales
```
db/
‚îú‚îÄ‚îÄ schema.sql                          # Schema principal ‚úÖ
‚îú‚îÄ‚îÄ seed.sql                            # Datos iniciales ‚úÖ
‚îú‚îÄ‚îÄ policies.sql                        # Pol√≠ticas RLS v1
‚îú‚îÄ‚îÄ policies-simple.sql                 # Pol√≠ticas RLS v2
‚îú‚îÄ‚îÄ policies-fixed.sql                  # Pol√≠ticas RLS v3
‚îú‚îÄ‚îÄ institutional-rls-policies.sql      # Pol√≠ticas RLS v4
‚îú‚îÄ‚îÄ advanced-rls-policies.sql           # Pol√≠ticas avanzadas
‚îú‚îÄ‚îÄ slot-locks-schema.sql               # Sistema de bloqueo ‚ö†Ô∏è
‚îú‚îÄ‚îÄ authentication-setup.sql            # Setup autenticaci√≥n ‚ö†Ô∏è
‚îú‚îÄ‚îÄ authentication-test.sql             # Tests autenticaci√≥n
‚îî‚îÄ‚îÄ [varios scripts de backup/reset]
```

**Tareas**:
- [ ] **Consolidar pol√≠ticas RLS**: Analizar las 4 versiones y crear una definitiva
- [ ] **Implementar slot locking**: Integrar `slot-locks-schema.sql` al schema principal
- [ ] **Migrar a Supabase**: Aplicar migrations v√≠a Supabase CLI
- [ ] **Verificar RLS**: Tests de aislamiento multi-tenant
- [ ] **Setup autenticaci√≥n**: Implementar `authentication-setup.sql`
- [ ] **Crear usuarios demo**: Ejecutar `demo-users-setup.sql`
- [ ] **Documentar schema**: Actualizar README con diagrama ER
- [ ] **Scripts de mantenimiento**: Consolidar archivos de backup/reset

**Pol√≠ticas RLS cr√≠ticas a implementar**:
- Usuarios solo ven instituciones donde tienen membres√≠a
- Profesionales solo ven sus propios turnos
- Pantalla p√∫blica solo accede a datos an√≥nimos de su instituci√≥n
- Administradores pueden gestionar su instituci√≥n completa

---

### 5. üìä SPRINT 5: Dashboard y Reportes
**Tiempo estimado**: 1 semana

#### Reportes y M√©tricas
**Archivo**: `app/(dashboard)/reportes/page.tsx` ‚úÖ Ya existe

**Funcionalidades a implementar**:
- [ ] **M√©tricas clave**:
  - Tiempo de espera promedio (objetivo: reducir 25-40%)
  - Tasa de absentismo (objetivo: reducir 10-20%)
  - Ocupaci√≥n de agenda (objetivo: ‚â•85%)
  - Cantidad de turnos por estado
  - Turnos por profesional/servicio

- [ ] **Gr√°ficos** (usar Recharts):
  - L√≠nea de tiempo: turnos por d√≠a/semana/mes
  - Barras: distribuci√≥n por estado
  - Torta: turnos por servicio
  - Heatmap: horarios m√°s demandados

- [ ] **Filtros**:
  - Rango de fechas
  - Instituci√≥n
  - Profesional
  - Servicio

- [ ] **Exportaci√≥n**:
  - CSV para an√°lisis externo
  - PDF para reportes ejecutivos

#### Dashboard Principal
**Archivo**: `app/(dashboard)/dashboard/page.tsx` ‚úÖ Ya existe

**Funcionalidades**:
- [ ] Resumen de turnos del d√≠a (tarjetas con n√∫meros)
- [ ] Lista de turnos pr√≥ximos
- [ ] Alertas: slots vac√≠os, ausencias del d√≠a
- [ ] Accesos r√°pidos seg√∫n rol del usuario
- [ ] Estad√≠sticas en tiempo real

---

## Riesgos y Deuda T√©cnica Identificada

### üî¥ Cr√≠ticos
1. **M√∫ltiples versiones de archivos sin consolidar**:
   - `turnos/page.tsx` (3 versiones)
   - Pol√≠ticas RLS (4 archivos diferentes)

2. **Autenticaci√≥n no integrada**: Archivos SQL presentes pero no aplicados

3. **Sistema de concurrencia incompleto**: `slot-locks-schema.sql` no integrado

### üü° Importantes
4. **Falta de tests**: No hay framework configurado (Jest instalado pero sin tests)

5. **Validaci√≥n de datos**: Falta validaci√≥n robusta en formularios (usar Zod m√°s extensivamente)

6. **Manejo de errores**: No hay estrategia unificada de error boundaries

### üü¢ Deseables
7. **Optimizaci√≥n de queries**: Falta paginaci√≥n en listados grandes

8. **Cach√©**: No hay estrategia de cach√© para datos est√°ticos

9. **Logs y auditor√≠a**: Falta sistema de auditor√≠a de acciones cr√≠ticas

---

## Dependencias y Tecnolog√≠as Disponibles

### Ya instaladas ‚úÖ
- **UI**: shadcn/ui 3, Tailwind CSS 4, Lucide Icons
- **Formularios**: react-hook-form, @hookform/resolvers, zod
- **Fechas**: date-fns, react-day-picker
- **Backend**: Supabase (SSR, Auth, Realtime)
- **Gr√°ficos**: Recharts
- **Testing**: Jest, Testing Library (sin configurar)

### Por considerar üîµ
- **Notificaciones push**: Para recordatorios de turnos
- **Email**: Para confirmaciones (Supabase tiene integraci√≥n)
- **SMS**: Para recordatorios (requiere servicio externo)
- **PDF generation**: Para comprobantes de turnos
- **Telemetr√≠a**: Para monitorear performance

---

## Orden de Ejecuci√≥n Recomendado

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ FASE 0: CORRECCI√ìN INMEDIATA (D√≠a 1)           ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ 1. Corregir errores TypeScript                 ‚îÇ
‚îÇ 2. Verificar build exitoso                     ‚îÇ
‚îÇ 3. Commit: "fix: typescript errors en pantalla" ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ SPRINT 2: TURNOS CORE (Semanas 1-2)            ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ Semana 1:                                       ‚îÇ
‚îÇ - 2A. CRUD Consultorios (2 d√≠as)               ‚îÇ
‚îÇ - 2B. CRUD Servicios (2 d√≠as)                  ‚îÇ
‚îÇ - 2C. Sistema Horarios inicio (1 d√≠a)          ‚îÇ
‚îÇ                                                 ‚îÇ
‚îÇ Semana 2:                                       ‚îÇ
‚îÇ - 2C. Sistema Horarios completar (2 d√≠as)      ‚îÇ
‚îÇ - 2D. Refactorizar Turnos (2 d√≠as)             ‚îÇ
‚îÇ - 2E. Turnos Disponibles (1 d√≠a)               ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ SPRINT 3: REAL-TIME (Semanas 3-4)              ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ Semana 3:                                       ‚îÇ
‚îÇ - 3B. Vista Profesional (3 d√≠as)               ‚îÇ
‚îÇ - 3A. Pantalla P√∫blica mejoras (2 d√≠as)        ‚îÇ
‚îÇ                                                 ‚îÇ
‚îÇ Semana 4:                                       ‚îÇ
‚îÇ - Testing integral (3 d√≠as)                    ‚îÇ
‚îÇ - Ajustes de UX (2 d√≠as)                       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ SPRINT 4: BASE DE DATOS (Semana 5)             ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ - 4. Consolidar RLS (2 d√≠as)                   ‚îÇ
‚îÇ - 4. Implementar slot locking (1 d√≠a)          ‚îÇ
‚îÇ - 4. Migrar a Supabase (1 d√≠a)                 ‚îÇ
‚îÇ - 4. Setup autenticaci√≥n (1 d√≠a)               ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ SPRINT 5: REPORTES (Semana 6)                  ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ - 5. Dashboard (2 d√≠as)                        ‚îÇ
‚îÇ - 5. Reportes y gr√°ficos (2 d√≠as)              ‚îÇ
‚îÇ - Documentaci√≥n final (1 d√≠a)                  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## Criterios de √âxito por Sprint

### Sprint 2: Turnos Core
- ‚úÖ CRUD consultorios y servicios funcional
- ‚úÖ Sistema de horarios genera slots correctamente
- ‚úÖ Solo una versi√≥n de `turnos/page.tsx` (consolidada)
- ‚úÖ Se pueden crear turnos sin conflictos
- ‚úÖ `npm run typecheck` pasa sin errores
- ‚úÖ `npm run lint` pasa sin warnings

### Sprint 3: Real-time
- ‚úÖ Profesional puede llamar pacientes desde su panel
- ‚úÖ Pantalla p√∫blica se actualiza en <2 segundos
- ‚úÖ Sistema de sonido funciona correctamente
- ‚úÖ Estados de turnos se registran en `call_events`
- ‚úÖ No hay memory leaks en suscripciones Realtime

### Sprint 4: Base de Datos
- ‚úÖ Una sola versi√≥n de pol√≠ticas RLS
- ‚úÖ RLS impide acceso cross-tenant
- ‚úÖ Slot locking previene doble reserva
- ‚úÖ Autenticaci√≥n funciona con roles
- ‚úÖ Datos demo cargados correctamente

### Sprint 5: Reportes
- ‚úÖ Dashboard muestra m√©tricas en tiempo real
- ‚úÖ Reportes generan datos correctos
- ‚úÖ Gr√°ficos son legibles y √∫tiles
- ‚úÖ Exportaci√≥n CSV funciona
- ‚úÖ Performance <2s para queries de reportes

---

## Pr√≥ximas Decisiones Requeridas

1. **¬øConsolidar archivos ahora o despu√©s?**
   - Turnos: ¬øCu√°l de las 3 versiones es la base?
   - RLS: ¬øCu√°l pol√≠tica es la m√°s completa?

2. **¬øImplementar autenticaci√≥n antes o despu√©s de Sprint 2?**
   - Pro de antes: Desarrollo con contexto de usuario real
   - Pro de despu√©s: M√°s funcionalidad visible primero

3. **¬øConfigurar testing ahora o al final?**
   - Jest ya instalado pero sin tests
   - ¬øTest-driven o testing despu√©s de MVP?

4. **¬øModo de desarrollo?**
   - ¬øUsar Supabase local o proyecto cloud?
   - ¬øConfigurar Git hooks con lint/typecheck?

---

## Recursos y Referencias

### Documentaci√≥n
- Next.js 15: https://nextjs.org/docs
- Supabase: https://supabase.com/docs
- shadcn/ui: https://ui.shadcn.com
- Tailwind CSS 4: https://tailwindcss.com

### Archivos de Referencia en Proyecto
- `CLAUDE.md`: Instrucciones del proyecto
- `docs/sprint_1_completed.md`: Detalle de lo completado (en memoria)
- `db/schema.sql`: Schema completo de base de datos
- `components.json`: Configuraci√≥n shadcn/ui

### Memoria del Proyecto (`.serena/memories/`)
- `project_overview.md`
- `project_structure.md`
- `code_style_and_conventions.md`
- `sprint_1_completed.md`
- `task_completion_checklist.md`

---

## Notas Finales

Este documento debe actualizarse conforme se completen sprints. Cada sprint debe terminar con:

1. ‚úÖ Todos los tests pasando (cuando existan)
2. ‚úÖ `npm run typecheck` sin errores
3. ‚úÖ `npm run lint` sin warnings
4. ‚úÖ `npm run build` exitoso
5. ‚úÖ Update de memoria `.serena` con progreso
6. ‚úÖ Commit descriptivo en Git

---

**Documento generado**: 2025-10-03
**Pr√≥xima revisi√≥n**: Despu√©s de completar correcciones TypeScript
